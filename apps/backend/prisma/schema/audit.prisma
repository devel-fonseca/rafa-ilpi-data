// ──────────────────────────────────────────────────────────────────────────────
//  AUDITORIA - TENANT TABLE (Isolamento Total)
//
//  Cada tenant possui sua própria tabela audit_logs no schema tenant_xxx
//  Isolamento físico garantido pela arquitetura multi-tenant
// ──────────────────────────────────────────────────────────────────────────────

model AuditLog {
  id         Int      @id @default(autoincrement())
  tenantId   String   @map("tenant_id") @db.Uuid // Stored for reference, no FK (cross-schema)
  entityType String   @map("entity_type") @db.VarChar(50)
  entityId   String?  @map("entity_id") @db.VarChar(255)
  action     String   @db.VarChar(50)
  userId     String   @map("user_id") @db.VarChar(255)
  userName   String   @map("user_name") @db.VarChar(255)
  details    Json?
  ipAddress  String?  @map("ip_address") @db.VarChar(45)
  userAgent  String?  @map("user_agent") @db.Text
  createdAt  DateTime @default(now()) @map("created_at") @db.Timestamptz(3)

  // Índices
  @@index([createdAt(sort: Desc)])
  @@index([entityType])
  @@index([userId])
  @@index([action])
  @@map("audit_logs")
}
