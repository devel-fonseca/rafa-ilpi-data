// ──────────────────────────────────────────────────────────────────────────────
//  TENANT STATISTICS CACHE
//
//  Tabela de cache para estatísticas de tenants que evita queries N+1
//  Atualizada periodicamente por job em background
// ──────────────────────────────────────────────────────────────────────────────

model TenantStats {
  id String @id @default(uuid()) @db.Uuid

  tenantId String @unique @db.Uuid

  // Contadores cacheados
  usersCount     Int @default(0) @map("users_count")
  residentsCount Int @default(0) @map("residents_count")

  // Metadata
  lastUpdatedAt DateTime @default(now()) @map("last_updated_at") @db.Timestamptz(3)
  createdAt     DateTime @default(now()) @db.Timestamptz(3)
  updatedAt     DateTime @updatedAt @db.Timestamptz(3)

  tenant Tenant @relation(fields: [tenantId], references: [id], onDelete: Cascade)

  @@index([tenantId])
  @@index([lastUpdatedAt])
  @@map("tenant_stats")
}
