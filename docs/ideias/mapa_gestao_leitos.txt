Preciso imaginar uma gest√£o/Mapa de Leitos. Quero estruturar isso da forma **mais inteligente, flex√≠vel e escal√°vel**, sem mexer na tabela `Residents` ‚Äî respeitando seus campos `roomId` e `bedId`.

A id√©ia √© um **modelo universal**, capaz de atender:

* ILPI com **uma casa simples**, t√©rrea
* ILPI com **dois ou tr√™s andares**
* ILPI com **v√°rios pr√©dios** dentro do mesmo terreno
* ILPI com **pavilh√µes** separados
* ILPI com **quartos coletivos**, su√≠tes ou unidades privativas

Para isso, a solu√ß√£o mais robusta √© um **modelo multin√≠vel**, mas **com o m√≠nimo de complica√ß√£o**.

A seguir est√° o *modelo ideal*.

---

# ‚úÖ **1. Estrutura recomendada (resumida)**

**N√çVEL 1: buildings (pr√©dios / blocos)**
**N√çVEL 2: floors (andares / setores)**
**N√çVEL 3: rooms (quartos)**
**N√çVEL 4: beds (leitos)** ‚Üê conecta com Residents

---

# üî• **2. Por que este modelo √© o ideal?**

‚úî Funciona para ILPI pequena (1 casa ‚Üí 1 building ‚Üí 1 floor)
‚úî Funciona para ILPI grande (3 pr√©dios, 12 andares, 80 quartos)
‚úî Evita gambiarra no frontend
‚úî Mant√©m `roomId` e `bedId` funcionando sem mudar tabela de residentes
‚úî Permite simular realidades do setor (ala feminina, pavilh√£o cl√≠nico, isolamentos, etc.)

---

# üß± **3. Tabelas sugeridas (simples e poderosas)**

## **üìå 1) buildings (pr√©dios / blocos)**

```
id (PK)
name                 // "Pr√©dio A", "Casa Principal", "Bloco Azul"
description          // opcional
active               // boolean
createdAt
updatedAt
organizationId       // multi-tenant
```

## **üìå 2) floors (andares / setores / pavilh√µes)**

```
id (PK)
buildingId (FK -> buildings)
name                  // "T√©rreo", "1¬∫ Andar", "Ala Norte", "Pavilh√£o Feminino"
orderIndex            // ordena√ß√£o para exibi√ß√£o
description           // opcional
active                // boolean
createdAt
updatedAt
organizationId
```

> Observa√ß√£o:
> ‚ÄúFloor‚Äù √© s√≥ o nome t√©cnico ‚Äî pode representar **andares, alas, setores**.

## **üìå 3) rooms (quartos)**

```
id (PK)
floorId (FK -> floors)
name                // "101", "Quarto 3", "Su√≠te 2"
capacity            // n√∫mero total de leitos
type                // "Quarto Coletivo", "Su√≠te", "Enfermaria", etc.
genderRestriction   // null, "M", "F" ‚Äî se existir
notes               // observa√ß√µes (acessibilidade, banheiro interno)
active              // boolean
createdAt
updatedAt
organizationId
```

## **üìå 4) beds (leitos)**

(conecta diretamente com Residents)

```
id (PK)
roomId (FK -> rooms)
code               // "101-A", "101-B", "Leito 2", etc.
status             // "Dispon√≠vel", "Ocupado", "Manuten√ß√£o"
notes              // observa√ß√µes (prefer√™ncia da fam√≠lia, leito adaptado)
active
createdAt
updatedAt
organizationId
```

# üü¶ **4. Rela√ß√£o com Residents (j√° existente)**

Mant√©r exatamente o que j√° tem:

```
Residents {
  roomId  (FK ‚Üí rooms)
  bedId   (FK ‚Üí beds)
}
```

Sem alterar nada.

---

# üé® **5. Como isso vira o Mapa de Leitos (frontend)**

O frontend renderiza:

**building ‚Üí floor ‚Üí room ‚Üí bed**

Exemplo:

```
Casa Principal
   T√©rreo
      Quarto 1
         Leito A ‚Äî Ocupado (Maria)
         Leito B ‚Äî Dispon√≠vel
      Quarto 2
         Leito A ‚Äî Ocupado (Jos√©)
   1¬∫ Andar
      Quarto 3
         Leito A ‚Äî Dispon√≠vel
         Leito B ‚Äî Manuten√ß√£o

Pr√©dio Anexo
   Enfermaria Geral
      Sala 1
         Leito A ‚Äî Ocupado
```

---

# üîç **6. E se a ILPI for ‚Äúcasa comum‚Äù, sem andares?**

Basta cadastrar:

```
Building: "Casa"
Floor: "√önico"
Rooms: (Quarto 1, Quarto 2 ...)
Beds: (Leito A, Leito B...)
```

Funciona igual ‚Äî o modelo √© **flex√≠vel**.

---

# üìå **7. Campos realmente importantes (sem exageros)**

**rooms**

* id, floorId, name, capacity

**beds**

* id, roomId, code, status

Os demais s√£o incrementais.

---

# üéØ **8. Wireframe do Mapa de Leitos (Dashboard visual)**

Aqui est√° o **wireframe do Mapa de Leitos (Dashboard visual)** em vers√£o texto ‚Äî simples, direto e perfeito para transformar depois em prot√≥tipo, layout ou componente React.

Estruturei exatamente como um administrador / RT espera visualizar o mapa:
**Pr√©dio ‚Üí Andar/Setor ‚Üí Quarto ‚Üí Leitos**, com ocupa√ß√£o e a√ß√µes.

---

# **üìå Wireframe ‚Äì Mapa de Leitos (Vers√£o Texto / Visual)**

```
=================================================================
                     MAPA DE LEITOS ‚Äì VIS√ÉO GERAL
=================================================================

[Filtros superiores]
---------------------------------------------------------------
[Pr√©dio: ‚ñº]   [Andar/Setor: ‚ñº]   [Status: ‚ñº]   [Buscar quarto/leito üîç]
---------------------------------------------------------------


=================================================================
BLOCO / PR√âDIO SELECIONADO (ex.: Casa Principal)
=================================================================

> ANDAR / SETOR: T√âRREO
---------------------------------------------------------------

 Quarto 101                           Quarto 102
 -------------------------------       ----------------------------
 [Icone porta] 101                    [Icone porta] 102
 Capacidade: 2 leitos                 Capacidade: 3 leitos

    [Leito 101-A]                     [Leito 102-A]
    [üü© Dispon√≠vel]                   [üü• Ocupado ‚Äì Maria Silva]
    A√ß√µes: [Ver residente] [Mover]

    [Leito 101-B]                     [Leito 102-B]
    [üü© Dispon√≠vel]                   [üüß Manuten√ß√£o]
    A√ß√µes: [Editar leito]

                                       [Leito 102-C]
                                       [üü• Ocupado ‚Äì Jos√© Oliveira]
                                       A√ß√µes: [Ver residente] [Transferir]

---------------------------------------------------------------

> ANDAR / SETOR: PRIMEIRO ANDAR
---------------------------------------------------------------

 Quarto 201                           Quarto 202
 -------------------------------       ----------------------------
 [Icone porta] 201                    [Icone porta] 202
 Capacidade: 2 leitos                 Capacidade: 1 leito

    [Leito 201-A]                     [Leito 202-A]
    [üü• Ocupado ‚Äì Ana Paula]          [üü© Dispon√≠vel]
    A√ß√µes: [Ver residente]

    [Leito 201-B]
    [üü© Dispon√≠vel]
    A√ß√µes: [Editar]

---------------------------------------------------------------


=================================================================
RESUMO LATERAL (painel fixo √† direita)
=================================================================
 Total de leitos: 18
 Ocupados: 7
 Dispon√≠veis: 9
 Em manuten√ß√£o: 2

 [Bot√£o] + Adicionar Quarto
 [Bot√£o] + Adicionar Leito
 [Bot√£o] Configurar Pr√©dios / Andares

=================================================================
```

---

# **üß† L√≥gica visual aplicada**

* **Hierarquia clara:** pr√©dio ‚Üí setor ‚Üí quarto ‚Üí leito
* **Uso de sem√°foro:** verde (dispon√≠vel), vermelho (ocupado), laranja (manuten√ß√£o)
* **A√ß√µes r√°pidas:** ver residente, mover, editar
* **Resumo lateral:** administra√ß√£o sempre sabe a taxa de ocupa√ß√£o
* **Escal√°vel:** inclui pr√©dios, pavilh√µes, alas e casas pequenas

---

# **üéØ Vers√£o super compacta para decis√£o r√°pida**

```
MAPA DE LEITOS

[Filtros: Pr√©dio | Andar | Status | Busca]

Casa Principal
  T√©rreo
    Quarto 101: [A: dispon√≠vel] [B: dispon√≠vel]
    Quarto 102: [A: ocupado] [B: manuten√ß√£o] [C: ocupado]
  1¬∫ Andar
    Quarto 201: [A: ocupado] [B: dispon√≠vel]
    Quarto 202: [A: dispon√≠vel]

Resumo: 18 leitos ¬∑ 7 ocupados ¬∑ 9 dispon√≠veis ¬∑ 2 manuten√ß√£o
```

---


1. **Como adicionar/remover leitos dentro do Mapa de Leitos?**
2. **Como integrar isso ao campo de quantidade de vagas/leitos dispon√≠veis da ficha de cadastro da ILPI?**

Vou resolver ambos de maneira simples e robusta.

---

# ‚úÖ 1. COMO ADICIONAR OU REMOVER LEITOS NO MAPA

### **üìå Filosofia: o quarto manda no leito ‚Äî o total da ILPI √© calculado automaticamente.**

Nenhuma ILPI adiciona leitos ‚Äúsoltos‚Äù.
O leito sempre pertence a um quarto.

Por isso a forma mais segura (e universal) √©:

---

## **üìå A) Tela de ‚ÄúGerenciar Quarto‚Äù**

Cada quarto ter√° um painel pr√≥prio:

```
QUARTO 101
-------------------------------------
Capacidade: [2]
Leitos Atuais:
  - 101-A (Ocupado)
  - 101-B (Dispon√≠vel)

[A√ß√µes]
+ Adicionar Leito
üóë Remover Leito
‚úèÔ∏è Renomear Leito
```

---

## **üìå B) Fluxo de Adicionar Leito**

Ao clicar:

```
+ Adicionar Leito
```

Modal:

```
Adicionar Leito ao Quarto 101
C√≥digo do Leito: [ 101-C ]
Status inicial: [Dispon√≠vel ‚ñº]

[Confirmar]     [Cancelar]
```

A capacidade do quarto √© atualizada automaticamente:

```
Capacidade: 2 ‚Üí 3
```

---

## **üìå C) Fluxo de Remover Leito**

Se o leito estiver vazio:

```
[Remover]
Confirma remover o leito 101-B?

[Sim] [N√£o]
```

Se estiver ocupado:

```
Este leito est√° vinculado a um residente.
Para remover, transfira ou d√™ baixa no residente.
```

---

# üî• 2. COMO INTEGRAR AO CAMPO ‚ÄúQUANTIDADE DE LEITOS‚Äù DA ILPI?

## üìå **A forma ideal: o sistema calcula automaticamente a quantidade de leitos**

### **1) Campo ‚ÄúQuantidade de Leitos Existentes‚Äù**

‚Üí Calculado pela soma dos leitos cadastrados no Mapa de Leitos:

```
SELECT COUNT(*) FROM beds WHERE organizationId = X
```

* Zero risco de erro humano
* Atualiza toda vez que um leito √© criado/removido

---

# üìå **Quantidade de leitos dispon√≠veis / ocupados**

```
Dispon√≠veis = COUNT(beds WHERE status = 'dispon√≠vel')
Ocupados    = COUNT(beds JOIN residents ON bedId)
Manuten√ß√£o  = COUNT(beds WHERE status = 'manuten√ß√£o')
```

Sem input manual.

---

# üìå **2. Campo ‚ÄúLeitos autorizados pela Vigil√¢ncia / Alvar√°‚Äù**

Esse **n√£o pode ser autom√°tico**, pois algumas ILPIs t√™m:

* 20 leitos autorizados
* 18 leitos f√≠sicos instalados
* 2 leitos extras ‚Äúem projeto‚Äù
* regras diversas conforme RDC 502 e vigil√¢ncia municipal

Este campo deve permanecer manual:

```
Leitos Autorizados: [   20   ]
```

---

# üéØ INTEGRA√á√ÉO FINAL E ELEGANTE

A ficha da ILPI ficaria assim:

```
LEITOS
--------------------------------------------------
Leitos autorizados pela Vigil√¢ncia: [20]
Leitos f√≠sicos cadastrados:         18 (calculado)
Leitos ocupados:                    14 (calculado)
Leitos dispon√≠veis:                 4  (calculado)
Leitos em manuten√ß√£o:               2  (calculado)
Bot√£o: [Gerenciar Mapa de Leitos]
```

Ou seja:

### **‚Üí O campo manual permanece apenas para ‚Äúleitos autorizados‚Äù.**

### **‚Üí Todo o resto vir√° automaticamente do Mapa de Leitos.**

---

# üß© 3. COMO REMOVER LEITOS SEM QUEBRAR INFORMA√á√ïES?

**Regra de ouro:**
Um leito s√≥ pode ser removido se vazio.

Fluxo:

1. Verifica se h√° resident bedId  vinculado
2. Se houver ‚Üí bloquear
3. If not ‚Üí apagar leito e recalcular capacidade do quarto

---

Segue o **wireframe completo do CRUD** de **Pr√©dios, Andares, Quartos e Leitos**, em formato totalmente visual e ideal para documenta√ß√£o, prototipagem e desenvolvimento.

Organizei de forma clara, com navega√ß√£o, listagens, bot√µes e formul√°rios.

---

# **üìå 1. Tela Principal ‚Äì Estrutura F√≠sica da ILPI**

```
================================================================================
                        ESTRUTURA F√çSICA DA ILPI
================================================================================

[Bot√µes superiores]
+ Adicionar Pr√©dio      + Adicionar Andar/Setor      + Adicionar Quarto

Listagem (modo √°rvore)
--------------------------------------------------------------------------------
Casas / Pr√©dios
   ‚ñº Casa Principal
       ‚ñº T√©rreo
           - Quarto 101   [Gerenciar]
           - Quarto 102   [Gerenciar]
       ‚ñº 1¬∫ Andar
           - Quarto 201   [Gerenciar]
           - Quarto 202   [Gerenciar]

   ‚ñº Anexo A
       ‚ñº Ala Feminina
           - Quarto 301   [Gerenciar]

--------------------------------------------------------------------------------
[Bot√£o] Abrir Mapa de Leitos
================================================================================
```

---

# **üìå 2. CRUD ‚Äì Pr√©dios (Buildings)**

## **A) Lista de Pr√©dios**

```
================================================================================
                                PR√âDIOS
================================================================================

[+ Adicionar Pr√©dio]

Tabela:
--------------------------------------------------------------------------------
Nome                 | Quartos | Leitos | Status | A√ß√µes
---------------------+---------+--------+--------+-------------------------------
Casa Principal       |   12    |   28   | Ativo  | [Editar] [Excluir]
Anexo A              |    6    |   14   | Ativo  | [Editar] [Excluir]
Anexo B              |    0    |    0   | Inativo| [Editar] [Excluir]
--------------------------------------------------------------------------------
```

---

## **B) Formul√°rio ‚Äì Adicionar / Editar Pr√©dio**

```
Adicionar Pr√©dio
------------------------------------------------------
Nome do Pr√©dio:       [ Casa Principal ]
Descri√ß√£o:            [Opcional]
Status:               [Ativo / Inativo]

[Cancelar]        [Salvar]
```

---

# **üìå 3. CRUD ‚Äì Andares / Setores (Floors)**

## **A) Lista de Andares (por Pr√©dio)**

```
================================================================================
                            ANDARES / SETORES
================================================================================

[+ Adicionar Andar/Setor]

Tabela:
--------------------------------------------------------------------------------
Nome               | Pr√©dio          | Quartos | Leitos | Ordem | A√ß√µes
-------------------+------------------+---------+--------+--------+------------
T√©rreo             | Casa Principal  |   5     |   12   |   1    | [Editar] [Excluir]
1¬∫ Andar           | Casa Principal  |   4     |   10   |   2    | [Editar] [Excluir]
Ala Feminina       | Anexo A         |   3     |    6   |   1    | [Editar] [Excluir]
--------------------------------------------------------------------------------
```

---

## **B) Formul√°rio ‚Äì Adicionar / Editar Andar**

```
Adicionar Andar/Setor
------------------------------------------------------
Pr√©dio:                 [ Casa Principal ‚ñº ]
Nome do Andar:          [ 1¬∫ Andar ]
Ordem de Exibi√ß√£o:      [ 2 ]
Descri√ß√£o:              [Opcional]
Status:                 [Ativo / Inativo]

[Cancelar]        [Salvar]
```

---

# **üìå 4. CRUD ‚Äì Quartos (Rooms)**

## **A) Lista de Quartos (por Andar)**

```
================================================================================
                                   QUARTOS
================================================================================

[+ Adicionar Quarto]

Tabela:
--------------------------------------------------------------------------------
Nome     | Andar/Setor | Pr√©dio         | Capacidade | Leitos | Tipo    | A√ß√µes
---------+--------------+----------------+------------+--------+---------+-------
101      | T√©rreo       | Casa Principal |     2      |   2    | Coletivo| [Gerenciar] [Editar] [Excluir]
102      | T√©rreo       | Casa Principal |     3      |   3    | Coletivo| [Gerenciar] [Editar] [Excluir]
201      | 1¬∫ Andar     | Casa Principal |     2      |   2    | Su√≠te   | [Gerenciar] [Editar] [Excluir]
--------------------------------------------------------------------------------
```

---

## **B) Formul√°rio ‚Äì Adicionar / Editar Quarto**

```
Adicionar Quarto
------------------------------------------------------
Pr√©dio:                 [ Casa Principal ‚ñº ]
Andar/Setor:            [ 1¬∫ Andar ‚ñº ]

Nome do Quarto:         [ 201 ]
Capacidade Inicial:     [ 2 ]
Tipo:                   [ Coletivo / Su√≠te / Enfermaria ‚ñº ]
Restri√ß√£o de G√™nero:    [ Nenhuma / Masculino / Feminino ‚ñº ]
Notas:                  [Texto opcional]

Ajuste autom√°tico:
‚ö† O sistema criar√° leitos iniciais com nomes:
   - 201-A
   - 201-B

[Cancelar]        [Salvar]
```

---

# **üìå 5. CRUD ‚Äì Leitos (Beds)**

A gest√£o dos leitos √© sempre **dentro do quarto**, para manter l√≥gica operacional.

---

## **A) Tela: Gerenciar Quarto ‚Äú201‚Äù**

```
================================================================================
                                 GERENCIAR QUARTO 201
================================================================================

Pr√©dio: Casa Principal
Andar:  1¬∫ Andar
Capacidade Atual: 2

Leitos:
--------------------------------------------------------------------------------
C√≥digo   | Status        | Residente           | A√ß√µes
---------+---------------+----------------------+-----------------------------
201-A    | Dispon√≠vel    | -                    | [Editar] [Remover]
201-B    | Ocupado       | Maria da Silva       | [Ver] [Transferir]
--------------------------------------------------------------------------------

[A√ß√µes do Quarto]
+ Adicionar Leito
‚úèÔ∏è Editar Quarto
üóë Remover Quarto (se todos os leitos estiverem vazios)
================================================================================
```

---

## **B) Modal: Adicionar Leito**

```
Adicionar Leito ao Quarto 201
------------------------------------------------------
C√≥digo do Leito: [ 201-C ]
Status Inicial:  [ Dispon√≠vel / Manuten√ß√£o ]
Notas:           [Opcional]

[Cancelar]    [Salvar]
```

---

## **C) Modal: Editar Leito**

```
Editar Leito 201-B
------------------------------------------------------
C√≥digo:     [ 201-B ]
Status:     [ Ocupado / Dispon√≠vel / Manuten√ß√£o ]
Notas:      [ ... ]

[Cancelar]  [Salvar]
```

---

## **D) Modal: Remover Leito**

### **Leito vazio**

```
Remover Leito 201-A?
Esta a√ß√£o n√£o pode ser desfeita.

[Cancelar]   [Remover]
```

### **Leito ocupado**

```
N√£o √© poss√≠vel remover este leito.
O leito est√° vinculado a:

- Maria da Silva (Residente)

Transfira o residente antes de remover o leito.

[Fechar]
```

---

# **üìå 6. Integra√ß√£o com o ‚ÄúMapa de Leitos‚Äù**

No canto superior ou nas a√ß√µes:

```
[üîé Ver Mapa de Leitos]
```

clicando leva ao dashboard visual com:

* Pr√©dios
* Andares
* Quartos
* Leitos
* Ocupa√ß√£o
* Transfer√™ncias

---

# **üìå 7. Estrutura de Navega√ß√£o Recomendada**

```
Gest√£o da ILPI
   ‚îú‚îÄ‚îÄ Estrutura F√≠sica (CRUD completo)
   ‚îú‚îÄ‚îÄ Mapa de Leitos (visual)
   ‚îî‚îÄ‚îÄ Configura√ß√µes
```

E cada item **abre uma p√°gina √∫nica**, com **abas internas** (tabs) ‚Äî n√£o no sidebar.

---

# üß© **1. Estrutura F√≠sica**

**A p√°gina interna ter√° abas:**

```
[Pr√©dios] [Andares] [Quartos] [Leitos]
```

---

# üõèÔ∏è **2. Mapa de Leitos**


P√°gina √∫nica, sem submenu.

---

# ‚öôÔ∏è **3. Configura√ß√µes**


**P√°gina interna com abas:**

```
[Gerais da ILPI] [Mapa de Leitos] [Usu√°rios] ...
```

---

# üöÄ BENEF√çCIOS

* Sidebar limpo
* 100% dentro do limite de 1 n√≠vel
* Estrutura l√≥gica para equipes da ILPI
* Cada m√≥dulo cresce por meio de abas internas, n√£o por menus laterais
* UX clara, profissional e escal√°vel

---

Claro que precisamos adaptar tudo isso para a realidade do sistema que estamos construindo, mantendo a identidade visual existente, sem alterar as tabelas e campos j√° existentes no banco de dados.
